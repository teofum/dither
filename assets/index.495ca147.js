var Le=Object.defineProperty,ze=Object.defineProperties;var Ge=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Be=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable;var ee=(e,n,t)=>n in e?Le(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,b=(e,n)=>{for(var t in n||(n={}))Be.call(n,t)&&ee(e,t,n[t]);if(ce)for(var t of ce(n))Ze.call(n,t)&&ee(e,t,n[t]);return e},R=(e,n)=>ze(e,Ge(n));var W=(e,n,t)=>(ee(e,typeof n!="symbol"?n+"":n,t),t);import{j as pe,r as S,R as we,a as Ye}from"./vendor.f81f3cea.js";const Qe=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function t(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerpolicy&&(r.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?r.credentials="include":l.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(l){if(l.ep)return;l.ep=!0;const r=t(l);fetch(l.href,r)}};Qe();var q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAFVBMVEUAAACAgIDAwMAAAAD///8A//8AgIA+In3bAAAAAXRSTlMAQObYZgAAAAFiS0dEBI9o2VEAAAAHdElNRQfiBBMBJCt84jxJAAAAWElEQVQI12NgQABGQUFBARBDSElJSRgk4OLioghmOBsbQxlhiVBGGowhKAhhOCkpKRoC9TMaA4GQAcQYRUUgQxgEBA0YGI1AwJiBQQRosIsTUMYYDJDcAABR5A0vWu5CGwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0wNC0xOVQwMTozNjo0My0wNDowMNV8Hl4AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMDQtMTlUMDE6MzY6NDMtMDQ6MDCkIabiAAAAAElFTkSuQmCC",fe="data:image/png;base64,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UmVhZHlxyWU8AAADdmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjg2ZThhMTUyLTY3YWUtOTI0OS1hNTcyLWJmOTY5NjczYjdhMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGRUYzQ0IzNTNFMTQxMUVBOTM2MEJBMjMxMUIwNTgyRiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGRUYzQ0IzNDNFMTQxMUVBOTM2MEJBMjMxMUIwNTgyRiIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpmOTU3NDFiYi0yY2U5LTFhNDUtYmY2MC1jY2Q4YWFhYzJjNzUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6ODZlOGExNTItNjdhZS05MjQ5LWE1NzItYmY5Njk2NzNiN2EwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/N1XTgAAAFBJREFUeNpi/P//PwMpgAnGYGRk/A/C6ArQxeEagDYxwhQgK0aWA4uhOwndFmTFKDZgU4CuGKsGbE7CqQHZzdj8hBFKuJyEYivZ8UAsAAgwAALnMRFw3KPlAAAAAElFTkSuQmCC",be="data:image/png;base64,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UmVhZHlxyWU8AAADdmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjg2ZThhMTUyLTY3YWUtOTI0OS1hNTcyLWJmOTY5NjczYjdhMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowMDQ1OTRGRDNFMTUxMUVBQTIyMUZGMkE5OTFBM0M5MSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowMDQ1OTRGQzNFMTUxMUVBQTIyMUZGMkE5OTFBM0M5MSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpmOTU3NDFiYi0yY2U5LTFhNDUtYmY2MC1jY2Q4YWFhYzJjNzUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6ODZlOGExNTItNjdhZS05MjQ5LWE1NzItYmY5Njk2NzNiN2EwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+fEJGSgAAADZJREFUeNpi/P//PwMjI+N/BgIAqI4RRDMxkAhY0E3ABpBdQLINw0EDC7aQwAcYQRFHCgAIMACrSw8T5h39PwAAAABJRU5ErkJggg==";const oe=(...e)=>e.join(" ");var Re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAMElEQVQokWMYBoARyQv/8XgHro4Jrvr/f0ZsKtHFmfBJYjMERQOyIlw2DnnAwMAAAJr8EvyXKpcyAAAAAElFTkSuQmCC",We="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAASklEQVQokd2PSQoAMAgDTT+uvtwiRenmvdSLmMTA0AeDQBARq3CYGcCItklHEfaVZW3zcQkv+v6QZoRVdSnJw+xAcCH9YHhtiKgDumQPB+3C89EAAAAASUVORK5CYII=";const i=pe.exports.jsx,E=pe.exports.jsxs;function Y(e){var r;let n=null,t=null;S.exports.useEffect(()=>{e.options.find(s=>s.value===e.value)||o(e.options[0])},[e.options]);const o=s=>{!s||(t&&t.classList.remove("show"),e.onChange&&e.onChange({selected:s}))},l=()=>{if(!(!n||!t))if(t.classList.contains("show"))t.classList.remove("show");else{const s=n.getBoundingClientRect();t.style.top=`${s.bottom}px`,t.style.left=`${s.left}px`,t.style.width=`${s.width}px`,t.classList.add("show");const d=A=>{const a=A.target;(n==null?void 0:n.contains(a))||(t&&t.classList.remove("show"),window.removeEventListener("mousedown",d))};window.addEventListener("mousedown",d)}};return E("div",{className:"cmb-root bevel inset",ref:s=>n=s,children:[i("input",{type:"text",className:"cmb-input",readOnly:!0,disabled:e.disabled,value:((r=e.options.find(s=>s.value===e.value))==null?void 0:r.name)||""}),i("button",{className:"cmb-button bevel",onClick:l,children:i("img",{src:e.disabled?We:Re,alt:"v"})}),i("div",{className:"cmb-option-list",ref:s=>t=s,children:e.options.map((s,d)=>i("div",{className:"cmb-option",onClick:()=>o(s),children:s.name},d))})]})}const Ue=[{className:"theme__default",displayName:"Default"},{className:"theme__dark",displayName:"Dark"},{className:"theme__2k",displayName:"2K"},{className:"theme__blue",displayName:"Steel"}],Ae=[{className:"hp",displayName:"HP 100LX 6x8"},{className:"hp-big",displayName:"HP 100LX 10x11"},{className:"apricot",displayName:"Apricot Xen C"},{className:"siemens",displayName:"Siemens PC-D"},{className:"philips",displayName:"Philips :YES G"},{className:"ti",displayName:"TI Pro"},{className:"jpn12",displayName:"DOS/V JPN12"},{className:"jpn16",displayName:"DOS/V JPN16"},{className:"ank16",displayName:"DOS/V ANK16"},{className:"stingray",displayName:"CL Stingray 8x16"}];function Fe(){var M,C,g;const e=document.documentElement.className.split(" "),n=e.find(c=>c.startsWith("theme__")),t=(M=e.find(c=>c.startsWith("font-base__")))==null?void 0:M.split("__")[1],o=(C=e.find(c=>c.startsWith("font-text__")))==null?void 0:C.split("__")[1],l=(g=e.find(c=>c.startsWith("font-title__")))==null?void 0:g.split("__")[1],[r,s]=S.exports.useState(n||""),[d,A]=S.exports.useState(t||""),[a,m]=S.exports.useState(o||""),[u,h]=S.exports.useState(l||""),p=oe(r,`font-base__${d}`,`font-text__${a}`,`font-title__${u}`);console.log(p);const w=()=>{document.documentElement.className=p,localStorage.setItem("__theme",p)};return E("div",{className:"theme-root content",children:[i("div",{className:"theme-preview bevel content",children:i("div",{className:oe("theme-preview-bg",p),children:i("div",{className:"theme-fake-frame bevel",children:E("div",{className:"win-main",children:[E("div",{className:"win-titlebar",children:[i("img",{className:"win-titlebar-icon",src:q,alt:"icon"}),i("div",{className:"win-titlebar-spacer"}),i("div",{className:"win-title",children:"Window Title"}),i("div",{className:"win-titlebar-spacer"}),E("div",{className:"win-titlebar-button-group",children:[i("div",{className:"win-titlebar-button fake-button icon-button bevel",children:i("img",{src:be,alt:"max"})}),i("div",{className:"win-titlebar-button fake-button icon-button bevel",children:i("img",{src:fe,alt:"x"})})]})]}),i("div",{className:"win-content theme-fake-content bevel",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit."}),E("div",{className:"action-bar",children:[i("div",{className:"fake-button bevel",children:"Cancel"}),i("div",{className:"fake-button bevel",children:"OK"})]})]})})})}),E("div",{className:"theme-settings",children:[i("span",{className:"theme-label",children:"Color Theme"}),i(Y,{value:r,options:Ue.map(c=>({name:c.displayName,value:c.className})),onChange:c=>s(c.selected.value)}),i("span",{className:"theme-label",children:"Text Font"}),i(Y,{value:a,options:Ae.map(c=>({name:c.displayName,value:c.className})),onChange:c=>m(c.selected.value)}),i("span",{className:"theme-label",children:"Title Font"}),i(Y,{value:u,options:Ae.map(c=>({name:c.displayName,value:c.className})),onChange:c=>h(c.selected.value)})]}),i("div",{className:"theme-actions action-bar",children:i("button",{className:"bevel",onClick:w,children:"Apply"})})]})}var Ve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAP1BMVEUAAADMzGb/zDP//4BmZmaysrKAgIDMM8wzM5kzMzPMMzP////AwMD/ZmaZZmZfX1+AAACZMzNmAACZAAB3d3cazDxqAAAAAXRSTlMAQObYZgAAAAFiS0dECx/XxMAAAAAHdElNRQfiBhoANRcGXhUDAAAAc0lEQVQY01WP2xLCIAwFuRSqhyJp9P+/VXJCnbpPsLOQSQgXMcZwJ+WcNz+WaqR9/4mHYUV6/gmguSkHmcnUZkojWzIo+mvQGHwCiEdH5acdco67gOhKXHS8PytxMYMmEI6uDMg5uIAHMoFcW6qarqrr/gXDPAZ1GQ9R2QAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0wNi0yNlQwMDo1MzoyMy0wNDowMGnd9RQAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMDYtMjZUMDA6NTM6MjMtMDQ6MDAYgE2oAAAAAElFTkSuQmCC";const Oe={title:"System Theme",minWidth:440,minHeight:400,maxWidth:440,iconUrl:Ve,autoSize:!0,maximizable:!1,children:i(Fe,{})};var je="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAPElEQVQokWMYBoAR5oX////DfcPIyPj/////jEh8uBwTup9BipFpdMCETTEuPlgNEhuriVjUDW3AwMAAAMqIDA8h6hYtAAAAAElFTkSuQmCC";function k(e){const[n,t]=S.exports.useState(!0);return E("div",{className:"pane-root bevel",children:[E("div",{className:"pane-titlebar",onClick:()=>t(!n),children:[i("span",{className:"pane-title",children:e.title}),i("div",{className:"pane-titlebar-spacer"}),i("img",{src:n?je:Re})]}),i("div",{className:"pane-content",style:n?void 0:{display:"none"},children:e.children})]})}const me=["B","K","M","G","T","P"],ke=e=>{let n=0;for(;e>=1e3&&n<me.length;)e=e/1e3,n++;const t=e.toString();return t.substring(0,t.includes(".")?5:4)+me[n]};function Je(e){let n=null;const t=r=>{e.onChange(r)},o=r=>{const s=r.target;if(s==null?void 0:s.files){const d=s.files[0];t(R(b({},e.options),{info:R(b({},e.options.info),{src:URL.createObjectURL(d),filename:d.name,meta:[{prop:"Size (bytes)",value:ke(d.size)}]}),element:null}))}},l=r=>{const s=r.target;t(R(b({},e.options),{info:R(b({},e.options.info),{width:s.naturalWidth,height:s.naturalHeight,meta:[...e.options.info.meta,{prop:"Dimensions",value:`${s.naturalWidth}x${s.naturalHeight}`}]}),element:s}))};return E("div",{className:"dlab-image-root",children:[i("input",{type:"file",style:{display:"none"},ref:r=>n=r,onChange:r=>o(r.nativeEvent)}),i("span",{className:"dlab-image-filename",children:e.options.info.filename||"No image"}),i("button",{className:"dlab-image-upload-button bevel",onClick:()=>n==null?void 0:n.click(),children:"Browse..."}),i("div",{className:"dlab-image-preview bevel inset light",children:e.options.info.src?i("img",{src:e.options.info.src,onLoad:r=>l(r.nativeEvent)}):i("span",{children:"No preview available"})}),i("div",{className:"dlab-image-meta",children:e.options.info.meta.map((r,s)=>E("div",{className:"dlab-image-meta-item",children:[i("span",{className:"dlab-image-meta-name",children:r.prop}),i("span",{className:"dlab-image-meta-value",children:r.value})]},s))})]})}var y=(e=>(e.CGA2Bit="IBM CGA 2-bit modes",e.RetroPC="Retro PCs",e.RetroVC="Retro Consoles",e.Mono="Monochrome",e.Duo="Dual Tone",e.RGB="RGB",e.CMYK="CMYK",e.Auto="Optimized (Auto)",e.User="User (custom)",e.Other="Other",e.Generated="__AUTOGENERATED",e.Hidden="__HIDDEN",e))(y||{}),U=(e=>(e.CPU="Software",e.GL="WebGL",e))(U||{}),L=(e=>(e[e.Input=0]="Input",e[e.Combo=1]="Combo",e[e.Range=2]="Range",e))(L||{}),Q=(e=>(e[e.KeepOriginalSize=0]="KeepOriginalSize",e[e.FitToSize=1]="FitToSize",e[e.ForceResize=2]="ForceResize",e))(Q||{}),V=(e=>(e.Ready="Ready",e.Rendering="Rendering...",e.Done="Done",e))(V||{});const Pe={renderTarget:null,options:{image:{info:{src:"",filename:"",width:0,height:0,meta:[]},element:null},resize:{mode:0,x:800,y:600},palette:{group:y.RetroPC,palette:null},process:{device:U.GL,process:null,settingValues:{}},liveRender:!0},status:{renderStatus:"Ready",lastRenderTime:0,renderWidth:0,renderHeight:0},view:1},Xe=[{value:Q.KeepOriginalSize,name:"Keep original size"},{value:Q.FitToSize,name:"Fit to size"},{value:Q.ForceResize,name:"Force resize"}];function He(e){const n=l=>{e.onChange(l)},t=l=>{const r=l.key;r!=="Backspace"&&!r.match(/[0-9]/)&&!r.startsWith("Arrow")&&l.preventDefault()},o=(l,r)=>{const d=l.target.value;n(R(b({},e.options),{[r]:parseInt(d||"0")}))};return E("div",{className:"dlab-resize-root",children:[i(Y,{value:e.options.mode,options:Xe,onChange:l=>n(R(b({},e.options),{mode:l.selected.value}))}),E("div",{className:"dlab-resize-inputs",children:[i("input",{type:"number",className:"bevel",value:e.options.x,disabled:e.options.mode===Q.KeepOriginalSize,onKeyDown:l=>t(l.nativeEvent),onInput:l=>o(l.nativeEvent,"x")}),i("span",{children:"x"}),i("input",{type:"number",className:"bevel",value:e.options.y,disabled:e.options.mode===Q.KeepOriginalSize,onKeyDown:l=>t(l.nativeEvent),onInput:l=>o(l.nativeEvent,"y")})]})]})}var v=(e=>(e[e.Indexed=0]="Indexed",e[e.Mono=1]="Mono",e[e.RGB=2]="RGB",e[e.Mixer=3]="Mixer",e[e.Auto=4]="Auto",e))(v||{});const Ke=(e,n)=>{const o=e.data.slice(0,4)[1]===1,l=(e.data.length-4)/5,r=o?[255,255,255]:[0,0,0],s=m=>e.data[4+m*5],d=m=>e.data[5+m*5],A=m=>e.data.slice(6+m*5,9+m*5),a=m=>{let u=n;for(let h=0;h<m;h++)u=~~(u/s(h));return u%s(m)};for(let m=0;m<l;m++)A(m).forEach((u,h)=>{o&&(u=255-u);const p=~~(u*d(m)),w=u-p,M=p+a(m)*~~(w/(s(m)-1));r[h]+=o?-M:M,r[h]<0&&(r[h]=0),r[h]>255&&(r[h]=255)});return r},re=e=>{switch(e.type){case v.Indexed:return e.data.length/3;case v.Mono:return e.data[0];case v.RGB:return e.data[0]*e.data[1]*e.data[2];case v.Mixer:{const n=(e.data.length-4)/5;let t=1;for(let o=0;o<n;o++)t*=e.data[4+o*5];return t}case v.Auto:return e.data[0];default:return 0}},_e=(e,n)=>{if(n<0||n>=re(e))throw new Error(`Color index ${n} out of bounds`);switch(e.type){case v.Indexed:return e.data.slice(n*3,n*3+3);case v.Mono:return e.data.slice(2,5).map(t=>{const o=~~(t*e.data[1]),l=t-o;return o+n*~~(l/(e.data[0]-1))});case v.Mixer:return Ke(e,n);case v.RGB:{const t=n%e.data[2],o=~~(n/e.data[2])%e.data[1];return[~~(n/(e.data[2]*e.data[1])),o,t].map((r,s)=>r*~~(255/(e.data[s]-1)))}case v.Auto:default:throw new Error("Invalid or Auto palette type")}},$=e=>Array.from({length:re(e)},(n,t)=>_e(e,t)),qe={name:"Windows 4-bit RGBI",type:v.Indexed,group:y.RetroPC,data:[0,0,0,0,0,128,0,128,0,0,128,128,128,0,0,128,0,128,128,128,0,192,192,192,128,128,128,0,0,255,0,255,0,0,255,255,255,0,0,255,0,255,255,255,0,255,255,255]},$e={name:"Commodore 64 (*)",type:v.Indexed,group:y.RetroPC,data:[0,0,0,98,98,82,137,137,137,173,173,173,255,255,255,159,78,68,203,126,117,109,84,18,161,104,60,201,212,135,154,226,155,92,171,94,106,191,198,136,126,203,80,69,155,160,87,163]},et={name:"Apple II (16-color) (*)",type:v.Indexed,group:y.RetroPC,data:[0,0,0,156,156,156,255,255,255,96,78,189,208,195,255,255,68,253,227,30,96,255,160,208,255,106,60,96,114,3,208,221,141,20,245,60,0,163,96,114,255,208,20,207,253]},tt={name:"Apple II High-res (6-color) (*)",type:v.Indexed,group:y.RetroPC,data:[0,0,0,255,255,255,255,68,253,255,106,60,20,245,60,20,207,253]},nt={name:"Apple IIGS (MCV)",type:v.Indexed,group:y.RetroPC,data:[0,0,0,221,0,51,0,0,153,221,34,221,0,119,34,85,85,85,34,34,255,102,170,255,136,85,0,255,102,0,170,170,170,255,153,136,17,221,0,255,255,0,68,255,153,255,255,255]},at={name:"Macintosh II (1987)",type:v.Indexed,group:y.RetroPC,data:[255,255,255,255,255,0,255,102,0,221,0,0,255,0,153,51,0,153,0,0,204,0,153,255,0,170,0,0,102,0,102,51,0,153,102,51,187,187,187,136,136,136,68,68,68,0,0,0]},ot={name:"16-color palette 1",type:v.Indexed,group:y.Other,data:[8,0,0,32,26,11,67,40,23,73,41,16,35,67,9,93,79,30,156,107,32,169,34,15,43,52,124,43,116,9,208,202,64,232,160,119,106,148,171,213,196,179,252,231,110,252,250,226]},it={name:"IBM CGA 4-bit RGBI",type:v.Indexed,group:y.RetroPC,data:[0,0,0,0,0,170,0,170,0,0,170,170,170,0,0,170,0,170,170,85,0,170,170,170,85,85,85,85,85,255,85,255,85,85,255,255,255,85,85,255,85,255,255,255,85,255,255,255]},rt={name:"CGA Mode 4 Palette 0 (low)",type:v.Indexed,group:y.CGA2Bit,data:[0,0,0,0,170,0,170,0,0,170,85,0]},st={name:"CGA Mode 4 Palette 0 (high)",type:v.Indexed,group:y.CGA2Bit,data:[0,0,0,85,255,85,255,85,85,255,255,85]},lt={name:"CGA Mode 4 Palette 1 (low)",type:v.Indexed,group:y.CGA2Bit,data:[0,0,0,0,170,170,170,0,170,170,170,170]},ct={name:"CGA Mode 4 Palette 1 (high)",type:v.Indexed,group:y.CGA2Bit,data:[0,0,0,85,255,255,255,85,255,255,255,255]},At={name:"CGA Mode 5 (low)",type:v.Indexed,group:y.CGA2Bit,data:[0,0,0,0,170,170,170,0,0,170,170,170]},mt={name:"CGA Mode 5 (high)",type:v.Indexed,group:y.CGA2Bit,data:[0,0,0,85,255,255,255,85,85,255,255,255]},dt={name:"Game Boy (2-bit MC)",type:v.Indexed,group:y.RetroVC,data:[15,56,15,48,98,48,139,172,15,155,188,15]},ut={name:"NES (All colors) (*)",type:v.Indexed,group:y.RetroVC,data:[0,0,0,40,40,40,168,168,168,0,24,32,0,96,112,0,192,208,144,224,232,0,30,0,0,104,16,0,200,112,144,232,200,0,104,0,40,192,32,168,232,160,0,24,0,8,88,0,112,176,0,200,224,144,16,0,0,96,64,0,192,152,0,232,216,136,64,0,0,160,32,0,248,128,24,248,200,160,88,0,0,208,16,0,248,112,104,248,192,192,88,0,16,208,0,88,248,112,176,248,192,224,56,0,80,160,8,168,248,104,248,248,192,248,0,8,112,88,24,216,152,104,248,208,184,248,0,8,120,8,48,224,80,120,248,176,192,248,0,8,88,0,72,184,32,160,248,168,216,248,72,72,72,160,160,160,248,248,248]},ht={name:"8-color RGB (3-bit, 1bpc)",type:v.RGB,group:y.RGB,data:[2,2,2]},gt={name:"16-color RGB (4-bit, 1-2-1)",type:v.RGB,group:y.RGB,data:[2,4,2]},vt={name:"32-color RGB (5-bit, 2-2-1)",type:v.RGB,group:y.RGB,data:[4,4,2]},pt={name:"64-color RGB (6-bit, 2bpc)",type:v.RGB,group:y.RGB,data:[4,4,4]},wt={name:"256-color RGB (8-bit, 3-3-2)",type:v.RGB,group:y.RGB,data:[8,8,4]},ft={name:"Black/White (1-bit MC)",type:v.Mono,group:y.Mono,data:[2,0,255,255,255]},bt={name:"Black/Green (1-bit MC)",type:v.Mono,group:y.Mono,data:[2,0,0,255,0]},Rt={name:"Black/Amber (1-bit MC)",type:v.Mono,group:y.Mono,data:[2,0,255,200,15]},Et={name:"4-tone Greyscale (2-bit MC)",type:v.Mono,group:y.Mono,data:[4,0,255,255,255]},yt={name:"4-tone Amber (2-bit MC)",type:v.Mono,group:y.Mono,data:[4,.04,255,200,15]},Nt={name:"16-tone Greyscale (4-bit MC)",type:v.Mono,group:y.Mono,data:[16,0,255,255,255]};v.Mono,y.Mono;const Ee=[st,rt,ct,lt,mt,At,qe,it,$e,et,tt,nt,at,dt,ut,ht,gt,vt,pt,wt,ft,Rt,bt,Et,yt,Nt,ot],It=Object.values(y).filter(e=>!e.startsWith("__")).filter(e=>Ee.filter(n=>n.group===e).length>0).map(e=>({name:e,value:e}));function Ct(e){const n=s=>{e.onChange(s)},t=Ee.filter(s=>s.group===e.options.group).map(s=>({name:s.name,value:s})),o=e.options.palette&&$(e.options.palette),l=(o==null?void 0:o.length)||0,r=l>64?"smaller":l>32?"small":"";return E("div",{className:"dlab-palette-root",children:[i(Y,{options:It,value:e.options.group,onChange:s=>n(R(b({},e.options),{group:s.selected.value}))}),i(Y,{options:t,value:e.options.palette,onChange:s=>n(R(b({},e.options),{palette:s.selected.value}))}),o&&i("div",{className:oe("dlab-palette-preview",r),children:o.map((s,d)=>i("div",{className:"dlab-palette-swatch bevel content",style:{background:`rgb(${s[0]}, ${s[1]}, ${s[2]})`}},d))})]})}var xt=`attribute vec4 a_position;
attribute vec2 a_texCoord;

varying vec2 v_texCoord;

void main() {
  gl_Position = a_position;

  v_texCoord = a_texCoord;
}`,Mt=`precision mediump float;

uniform sampler2D u_image;

varying vec2 v_texCoord;

void main() {
  vec3 color = texture2D(u_image, v_texCoord).xyz;

  gl_FragColor = vec4(color, 1.0);
}`,Tt=`precision mediump float;

#define PALETTE_SIZE $ // $ is replaced in JS before compiling

#define CE 0.1 // Error multiplier, [0.0, 1.0] higher = more dither
#define CLIST_SIZE % // Candidate list size, higher is better quality but slower

uniform vec3 u_palette[PALETTE_SIZE];
uniform vec2 u_texSize;
uniform float u_gamma;
uniform sampler2D u_image;
uniform sampler2D u_threshold;
uniform float u_err_mult;

varying vec2 v_texCoord;

vec3 gamma(vec3 color) {
  return vec3(
    pow(color.x, u_gamma),
    pow(color.y, u_gamma),
    pow(color.z, u_gamma)
  );
}

vec3 ungamma(vec3 color) {
  float ungamma = 1.0 / u_gamma;
  return vec3(
    pow(color.x, ungamma),
    pow(color.y, ungamma),
    pow(color.z, ungamma)
  );
}

float compare(vec3 c1, vec3 c2) {
  return length(c1 - c2);
}

float luma(vec3 color) {
  return color.x * 0.299 + color.y * 0.587 + color.z * 0.114;
}

void main() {
  vec2 thresholdCoord = fract(v_texCoord * u_texSize / 8.0);
  float threshold = texture2D(u_threshold, thresholdCoord).x;

  vec3 color = texture2D(u_image, v_texCoord).xyz;
  color = gamma(color);

  // Build a list of potential candidates
  vec3 error = vec3(0.0);
  vec3 clist[CLIST_SIZE];
  for (int i = 0; i < CLIST_SIZE; i++) {
    vec3 target = color + error * u_err_mult;
    vec3 candidate = vec3(0.0);
    float dMin = 999999999.0; // Absurdly large number

    // Find the closest color from palette
    for (int j = 0; j < PALETTE_SIZE; j++) {
      vec3 test = u_palette[j];
      test = gamma(test);
      float d = compare(target, test);
      if (d < dMin) {
        dMin = d;
        candidate = test;
      }
    }

    // And add it to the candidate list
    clist[i] = candidate;

    // By adding the candidate's error to the next iteration,
    // the next candidate will compensate for that error thus
    // getting closer to the original color.
    error += color - candidate;
  }

  // Insertion sort the candidate list by luma
  for (int i = 1; i < CLIST_SIZE; i++) {
    for (int j = CLIST_SIZE; j > 0; j--) {
      if (j > i) continue; // silly GLSL won't let me do j = i, next best thing
      if (luma(clist[j-1]) <= luma(clist[j])) break;
      vec3 temp = clist[j-1];
      clist[j-1] = clist[j];
      clist[j] = temp;
    }
  }

  int index = int(threshold * float(CLIST_SIZE));
  // Silly workaround for GLSL not allowing indexing by variables
  for (int i = 0; i < CLIST_SIZE; i++) {
    if (i == index) color = clist[i];
  }

  color = ungamma(color);

  gl_FragColor = vec4(color, 1.0);
}
`,St=`precision mediump float;

#define PALETTE_SIZE $ // $ is replaced in JS before compiling

uniform vec3 u_palette[PALETTE_SIZE];
uniform vec2 u_texSize;
uniform float u_gamma;
uniform sampler2D u_image;
uniform sampler2D u_threshold;

varying vec2 v_texCoord;

struct ColorMix {
  vec3 color1;
  vec3 color2;
  float ratio;
};

float mixError(vec3 target, vec3 cmix, float compDist, float rmh) {
  return length(target - cmix) + compDist * (abs(rmh) + 0.5) / (40.0 / float(PALETTE_SIZE));
}

vec3 gamma(vec3 color) {
  return vec3(
    pow(color.x, u_gamma),
    pow(color.y, u_gamma),
    pow(color.z, u_gamma)
  );
}

vec3 ungamma(vec3 color) {
  float ungamma = 1.0 / u_gamma;
  return vec3(
    pow(color.x, ungamma),
    pow(color.y, ungamma),
    pow(color.z, ungamma)
  );
}

void main() {
  vec2 thresholdCoord = fract(v_texCoord * u_texSize / 8.0);
  float threshold = texture2D(u_threshold, thresholdCoord).x;

  vec3 color = texture2D(u_image, v_texCoord).xyz;

  vec3 cmix = vec3(0.0);
  vec3 c1 = vec3(0.0);
  vec3 c2 = vec3(0.0);
  vec3 g1 = vec3(0.0);
  vec3 g2 = vec3(0.0);
  ColorMix bestMix = ColorMix(vec3(0.0), vec3(0.0), 0.33);
  float minError = 999999999.0; // absurdly large number

  for(int i1 = 0; i1 < PALETTE_SIZE; i1++) {
    for(int i2 = 0; i2 < PALETTE_SIZE; i2++) {
      if(i2 < i1)
        continue;

      c1 = u_palette[i1];
      c2 = u_palette[i2];

      g1 = gamma(c1);
      g2 = gamma(c2);
      
      for(int ratio = 0; ratio < 64; ratio++) {
        if(i1 == i2 && ratio > 0)
          break;
        float r64 = float(ratio) / 64.0;
        cmix = g1 + r64 * (g2 - g1);

        float cdist = length(c2 - c1);
        float error = mixError(color, ungamma(cmix), cdist, r64 - 0.5);
        if(error < minError) {
          minError = error;
          bestMix = ColorMix(c1, c2, r64);
        }
      }
    }
  }

  color = threshold < bestMix.ratio ? bestMix.color2 : bestMix.color1;

  gl_FragColor = vec4(color, 1.0);
}`;const H={imageVert:xt,imageFrag:Mt,patternFrag:Tt,bayerFrag:St},ye=e=>e.viewport(0,0,e.canvas.width,e.canvas.height),K=(e,n,t)=>{const o=e.createShader(n);if(!o)throw new Error("createShader: gl.createShader failed");if(e.shaderSource(o,t),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS))return o;const r=e.getShaderInfoLog(o);throw e.deleteShader(o),new Error(`createShader: compile error: ${r}`)},_=(e,n,t,o)=>{e.enableVertexAttribArray(n),e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(n,o.size,o.type,o.normalize||!1,o.stride||0,o.offset||0)},Ne=(e,n,t)=>{const o=e.createProgram();if(!o)throw new Error("linkProgram: gl.createProgram failed");if(e.attachShader(o,n),e.attachShader(o,t),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS))return o;const r=e.getProgramInfoLog(o);throw e.deleteProgram(o),new Error(`linkProgram: link error: ${r}`)},Ie=(e,n,t)=>{const o=e.createTexture();if(!o)throw new Error("tex2DFromData: failed to create texture");return e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,8,8,0,e.LUMINANCE,e.UNSIGNED_BYTE,new Uint8Array(n)),o},Ce=(e,n,t)=>{const o=e.createTexture();if(!o)throw new Error("tex2DFromImage: failed to create texture");return e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),o},Dt=[-1,1,-1,-1,1,1,-1,-1,1,-1,1,1],Lt=[0,0,0,1,1,0,0,1,1,1,1,0],zt=(e,n)=>e!==void 0?e:n;let te=null,de=null,J=null;const Gt=async(e,n)=>{if(!n.image.element)throw new Error("runBayerLike: Image is null");if(!n.palette.palette)throw new Error("runBayerLike: No palette selected");const t=e.getContext("webgl",{preserveDrawingBuffer:!0});if(!t)throw new Error("runBayerLike: WebGL is unavailable");const o=n.process.settingValues,l=$(n.palette.palette).flat().map(C=>C/255);ye(t),(n.palette.palette!==(J==null?void 0:J.palette.palette)||t!==de)&&(te=null),J=n,de=t;let r=te;if(!r){console.log("Compiling shaders...");const C=H.bayerFrag.replace(/\$/g,(~~(l.length/3)).toString()),g=K(t,t.VERTEX_SHADER,H.imageVert),c=K(t,t.FRAGMENT_SHADER,C);r=Ne(t,g,c),te=r}const s=t.getAttribLocation(r,"a_position"),d=t.getAttribLocation(r,"a_texCoord"),A=t.getUniformLocation(r,"u_palette"),a=t.getUniformLocation(r,"u_texSize"),m=t.getUniformLocation(r,"u_image"),u=t.getUniformLocation(r,"u_threshold"),h=t.getUniformLocation(r,"u_gamma"),p=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,p),t.bufferData(t.ARRAY_BUFFER,new Float32Array(Dt),t.STATIC_DRAW);const w=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,w),t.bufferData(t.ARRAY_BUFFER,new Float32Array(Lt),t.STATIC_DRAW),Ce(t,n.image.element,t.TEXTURE0);const M=[0,48,12,60,3,51,15,63,32,16,44,28,35,19,47,31,8,56,4,52,11,59,7,55,40,24,36,20,43,27,39,23,2,50,14,62,1,49,13,61,34,18,46,30,33,17,45,29,10,58,6,54,9,57,5,53,42,26,38,22,41,25,37,21].map(C=>C*4);Ie(t,M,t.TEXTURE1),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.useProgram(r),t.uniform3fv(A,l),t.uniform2f(a,t.canvas.width,t.canvas.height),t.uniform1i(m,0),t.uniform1i(u,1),t.uniform1f(h,zt(o.gamma,xe.settings.gamma.default)||0),_(t,s,p,{size:2,type:t.FLOAT}),_(t,d,w,{size:2,type:t.FLOAT}),t.drawArrays(t.TRIANGLES,0,6)},xe={device:U.GL,name:"Color Pair Matrix",settings:{gamma:{name:"Gamma",type:L.Range,min:1,max:8,step:.2,default:2.2,showValue:e=>e.toFixed(1)}},run:Gt},Bt=[{x:1,y:0,w:7/16},{x:-1,y:1,w:3/16},{x:0,y:1,w:5/16},{x:1,y:1,w:1/16}],Zt=[{x:1,y:0,w:7/48},{x:2,y:0,w:5/48},{x:-2,y:1,w:3/48},{x:-1,y:1,w:5/48},{x:0,y:1,w:7/48},{x:1,y:1,w:5/48},{x:2,y:1,w:3/48},{x:-2,y:2,w:1/48},{x:-1,y:2,w:3/48},{x:0,y:2,w:5/48},{x:1,y:2,w:3/48},{x:2,y:2,w:1/48}],Yt=[{x:1,y:0,w:8/42},{x:2,y:0,w:4/42},{x:-2,y:1,w:2/42},{x:-1,y:1,w:4/42},{x:0,y:1,w:8/42},{x:1,y:1,w:4/42},{x:2,y:1,w:2/42},{x:-2,y:2,w:1/42},{x:-1,y:2,w:2/42},{x:0,y:2,w:4/42},{x:1,y:2,w:2/42},{x:2,y:2,w:1/42}],Qt=[Bt,Zt,Yt];function ue(e,n=2.2){return e.map(t=>{let o=t/255;return o=o>.04045?Math.pow((o+.055)/1.055,n):o/12.92,o*100})}function Wt(e,n=2.2){return e.map(t=>{let o=t/100;return o=o>.0031308?1.055*Math.pow(o,1/n)-.055:o*12.92,~~(o*255)})}function Ut(e,n,t){let o=[],l=Number.POSITIVE_INFINITY;for(let r=0;r<n.length;r++){const s=t(e,n[r]);s<=l&&(o=n[r],l=s)}return o}const Ft=(e,n)=>(e[0]-n[0])*(e[0]-n[0])+(e[1]-n[1])*(e[1]-n[1])+(e[2]-n[2])*(e[2]-n[2]);function Vt(e,n,t,o){const l=e.width*e.height*4,r=e.width*4,s=Qt[t.matrix||0];if(!n.palette.palette)throw new Error("null palette");const d=$(n.palette.palette),A=t.gamma||2.2;for(let a=0;a<l;a+=4){const m=ue(Array.from(e.data.slice(a,a+3)),A);for(let u=0;u<3;u++)e.data[a+u]=m[u];a%(r*4)===0&&o&&o(a,l,e)}for(let a=0;a<d.length;a++)d[a]=ue(d[a],A);for(let a=0;a<l;a+=4){const m=Array.from(e.data.slice(a,a+3)),u=Ut(m,d,Ft),h=a%r/4;for(let w=0;w<3;w++)e.data[a+w]=Wt(u,A)[w];const p=m.map((w,M)=>(w-u[M])*(t.error_mult||1));for(let w=0;w<s.length;w++){const M=a+s[w].x*4+s[w].y*r;if(h+s[w].x>=0&&h+s[w].x<e.width)for(let C=0;C<3;C++)e.data[M+C]+=p[C]*s[w].w}a%(4*r)===0&&o&&o(a,l,e)}return e}const Ot={id:"ProcErrorDiffusion",name:"Error Diffusion",run:Vt,maxAllowedPaletteSize:65536,supports:{threads:!1,gamma:!0},complexity:e=>e*2},jt=[Ot];function kt(){return new Worker("/dither/assets/worker.f7ff6ab3.js",{type:"module"})}class Jt{constructor(){W(this,"worker");W(this,"busy",!1);W(this,"x",0);W(this,"y",0);W(this,"onprogress");W(this,"onfinish");W(this,"onerror");this.worker=new kt,this.worker.onmessage=n=>{const t=n.data;switch(t.msg){case 0:this.onprogress&&this.onprogress(R(b({},t.params),{partial:t.params.partial?{data:t.params.partial,x:this.x,y:this.y}:void 0}));break;case 1:this.onfinish&&this.onfinish({data:t.params.result,x:this.x,y:this.y}),this.busy=!1;break;case 2:this.onerror&&this.onerror(t.params.error),this.busy=!1;break}}}get ready(){return!this.busy}start(n,t){var o;return this.busy?!1:(this.busy=!0,this.worker.postMessage({dataIn:n.data,options:{palette:t.palette,process:{process:{name:(o=t.process.process)==null?void 0:o.name},settingValues:t.process.settingValues}}}),!0)}terminate(){this.worker.terminate()}}const Pt=navigator.hardwareConcurrency,ne=Math.max(~~(Pt/2),1),Xt=(e,n)=>new Promise((t,o)=>{var g;const l=n.image.element;if(!l)throw new Error("Image is null");const r=e.getContext("2d");if(!r)throw new Error("Unable to get output context");const s=document.createElement("canvas");s.width=e.width,s.height=e.height;const d=s.getContext("2d");if(!d)throw new Error("Unable to get temp context");d.drawImage(l,0,0,e.width,e.height);const A=(g=n.process.process)==null?void 0:g.name,a=jt.find(c=>c.name===A);if(!a)throw new Error(`Could not find async process ${A}`);const m=n.process.settingValues,u=n.palette.palette;if(!u)throw new Error("Palette is null");let h;if(!a.supports.threads)h=1;else if(m.autoThreads){const c=a.complexity(re(u)),T=e.width*e.height,I=~~(T/5e4*c/2048)+1;h=I>ne?ne:I,console.log(`Want ${I} threads for ${T}px @CR${c}, got ${h} (max ${ne})`)}else h=m.threads||1;let p=0;const w=~~(e.width/h/8)*8,M=e.width-w*h,C=new Date().getTime();for(let c=0;c<h;c++){const T=~~(M/8),I=c*w+8*(T<c?T:c),N=w+(c===h-1?M%8:T>c?8:0),f=d.getImageData(I,0,N,e.height);f||o("Unable to get image data from context");const z={data:f,x:I,y:0},F=new Jt;F.onprogress=G=>{const O=G.current/(N*4);G.partial&&r.putImageData(G.partial.data,I,0),r.fillStyle="#ff00ff",r.fillRect(I,O,N,2)},F.onfinish=G=>{r.putImageData(G.data,I,0),p--;const O=new Date().getTime();console.log(`Worker thread ${c+1} done in ${O-C}ms`),p===0&&(console.log(`${h} worker threads done in ${O-C}ms`),t())},F.onerror=G=>o(`Error in worker thread: ${G}`),console.log(`Starting worker thread ${c+1}/${h} w=${N}`),F.start(z,n),p++}}),Ht={device:U.CPU,name:"Error Diffusion",settings:{matrix:{name:"Model",type:L.Combo,options:[{name:"Floyd-Steinberg",value:0},{name:"JJ&N",value:1},{name:"Stucki",value:2}]},error_mult:{name:"Diffuse",type:L.Range,min:.5,max:1,step:.1,default:1,showValue:e=>e.toFixed(1)},gamma:{name:"Gamma",type:L.Range,min:1,max:4,step:.2,default:2.2,showValue:e=>e.toFixed(1)}},run:Xt},Kt=[-1,1,-1,-1,1,1,-1,-1,1,-1,1,1],_t=[0,0,0,1,1,0,0,1,1,1,1,0],he=(e,n)=>e!==void 0?e:n,Me=e=>[0,.01,.02,.05,.1,.2,.35,.5,.8,1][e];let ae=null,ge=null,P=null,X=null;const qt=async(e,n)=>{if(!n.image.element)throw new Error("runPatternDither: Image is null");if(!n.palette.palette)throw new Error("runPatternDither: No palette selected");const t=e.getContext("webgl",{preserveDrawingBuffer:!0});if(!t)throw new Error("runPatternDither: WebGL is unavailable");const o=n.process.settingValues,l=$(n.palette.palette).flat().map(g=>g/255);ye(t),(n.palette.palette!==(P==null?void 0:P.palette.palette)||o.clist_size!==(X==null?void 0:X.clist_size)||t!==ge)&&(ae=null),P=n,X=o,ge=t;let r=ae;if(!r){console.log("Compiling shaders...");const g=H.patternFrag.replace(/\$/g,(~~(l.length/3)).toString()).replace(/%/g,(o.clist_size||64).toString()),c=K(t,t.VERTEX_SHADER,H.imageVert),T=K(t,t.FRAGMENT_SHADER,g);r=Ne(t,c,T),ae=r}const s=t.getAttribLocation(r,"a_position"),d=t.getAttribLocation(r,"a_texCoord"),A=t.getUniformLocation(r,"u_palette"),a=t.getUniformLocation(r,"u_texSize"),m=t.getUniformLocation(r,"u_image"),u=t.getUniformLocation(r,"u_threshold"),h=t.getUniformLocation(r,"u_err_mult"),p=t.getUniformLocation(r,"u_gamma"),w=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,w),t.bufferData(t.ARRAY_BUFFER,new Float32Array(Kt),t.STATIC_DRAW);const M=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,M),t.bufferData(t.ARRAY_BUFFER,new Float32Array(_t),t.STATIC_DRAW),Ce(t,n.image.element,t.TEXTURE0);const C=[0,48,12,60,3,51,15,63,32,16,44,28,35,19,47,31,8,56,4,52,11,59,7,55,40,24,36,20,43,27,39,23,2,50,14,62,1,49,13,61,34,18,46,30,33,17,45,29,10,58,6,54,9,57,5,53,42,26,38,22,41,25,37,21].map(g=>g*4);Ie(t,C,t.TEXTURE1),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.useProgram(r),t.uniform3fv(A,l),t.uniform2f(a,t.canvas.width,t.canvas.height),t.uniform1i(m,0),t.uniform1i(u,1),t.uniform1f(h,Me(he(o.amount,ie.settings.amount.default)||0)),t.uniform1f(p,he(o.gamma,ie.settings.gamma.default)||0),_(t,s,w,{size:2,type:t.FLOAT}),_(t,d,M,{size:2,type:t.FLOAT}),t.drawArrays(t.TRIANGLES,0,6)},ie={device:U.GL,name:"Pattern Dither",settings:{clist_size:{name:"Mix",type:L.Combo,options:[{name:"64 level",value:64},{name:"16 level",value:16},{name:"4 level",value:4}]},amount:{name:"Dither",type:L.Range,max:9,step:1,default:5,showValue:e=>Me(e).toFixed(2)},gamma:{name:"Gamma",type:L.Range,min:1,max:8,step:.2,default:2.2,showValue:e=>e.toFixed(1)}},run:qt},Te=[ie,xe,Ht],$t=Object.values(U).filter(e=>Te.filter(n=>n.device===e).length>0).map(e=>({name:e,value:e}));function en(e){var A;const n=a=>{e.onChange(a)},t=(a,m)=>{n(R(b({},e.options),{settingValues:R(b({},e.options.settingValues),{[a]:m})}))},o=a=>{const m=a.key;m!=="Backspace"&&!m.match(/[0-9]/)&&!m.startsWith("Arrow")&&a.preventDefault()},l=(a,m)=>a!==void 0?a:m,r=Te.filter(a=>a.device===e.options.device).map(a=>({name:a.name,value:a})),s=((A=e.options.process)==null?void 0:A.settings)||{},d=Object.keys(s);return E("div",{className:"dlab-process-root",children:[i("span",{className:"dlab-process-label",children:"Device"}),i(Y,{options:$t,value:e.options.device,onChange:a=>n(R(b({},e.options),{device:a.selected.value}))}),i("span",{className:"dlab-process-label",children:"Process"}),i(Y,{options:r,value:e.options.process,onChange:a=>n(R(b({},e.options),{process:a.selected.value,settingValues:{}}))}),d.length>0&&i("hr",{className:"divider bevel horizontal"}),d.map(a=>{var h;let m;const u=l(e.options.settingValues[a],s[a].default);switch(s[a].type){case L.Input:m=i("input",{type:"number",className:"bevel",value:u,onKeyDown:p=>o(p.nativeEvent),onInput:p=>t(a,parseFloat(p.target.value))},a);break;case L.Combo:m=i(Y,{value:e.options.settingValues[a],options:s[a].options||[],onChange:p=>t(a,p.selected.value)},a);break;case L.Range:m=E("div",{className:"dlab-process-control",children:[i("input",{type:"range",min:s[a].min||0,max:s[a].max||1,step:s[a].step,value:u,onInput:p=>t(a,parseFloat(p.target.value))}),s[a].showValue&&i("span",{children:(h=s[a].showValue)==null?void 0:h.call(void 0,u||0)})]},a);break}return[i("span",{className:"dlab-process-label",children:s[a].name},a+"_label"),m]})]})}var x=(e=>(e.Options="options",e.Image="image",e.Resize="resize",e.Palette="palette",e.Process="process",e.Live="live",e.RenderTarget="renderTarget",e.Status="status",e.View="view",e))(x||{});const tn=(e,n)=>{switch(n.type){case x.RenderTarget:return R(b({},e),{renderTarget:n.payload});case x.Options:return R(b({},e),{options:n.payload});case x.Image:return R(b({},e),{options:R(b({},e.options),{image:n.payload})});case x.Resize:return R(b({},e),{options:R(b({},e.options),{resize:n.payload})});case x.Palette:return R(b({},e),{options:R(b({},e.options),{palette:n.payload})});case x.Process:return R(b({},e),{options:R(b({},e.options),{process:n.payload})});case x.Live:return R(b({},e),{options:R(b({},e.options),{liveRender:n.payload})});case x.Status:return R(b({},e),{status:n.payload});case x.View:return R(b({},e),{view:n.payload});default:return console.warn(`dlabReducer: bad action type '${n.type}'`),e}};var nn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAbElEQVQ4jcVT0QrAIAg8Rx/mp/Vp/ZnDNkGYjO166CAq8C5ND6uQm2+kjrQ49X6tMcYrQ1VnjO+Og3k2yLSAZ7okkLFfoOWL15Y/qEKu/yGAIuBXBl8FqC748FRDtr8L00xmBhFhDBVmJAHgBEPWGSOGADVyAAAAAElFTkSuQmCC";function an(){let e=null;const[n,t]=S.exports.useReducer(tn,Pe);S.exports.useEffect(()=>{const A=e,a=A==null?void 0:A.querySelector("canvas");if(!A||!a)return;a.style.width=`${n.view*a.width/16}rem`,A.scrollWidth>A.clientWidth||A.scrollHeight>A.clientHeight?A.classList.add("__scroll"):A.classList.remove("__scroll")},[n.view]),S.exports.useEffect(()=>{console.log("destroy"),t({type:x.RenderTarget,payload:void 0})},[n.options.process.device]),S.exports.useEffect(()=>{if(!n.renderTarget){console.log("create");const A=we.createElement("canvas");t({type:x.RenderTarget,payload:A})}},[n.options]),S.exports.useEffect(()=>{const A=n.options;if(A.image.element){console.log("check");const a=e==null?void 0:e.querySelector("canvas");if(!a)return;const[m,u]=[A.image.info.width,A.image.info.height];let[h,p]=[0,0];switch(A.resize.mode){case Q.KeepOriginalSize:h=m,p=u;break;case Q.ForceResize:h=A.resize.x,p=A.resize.y;break;case Q.FitToSize:{const w=Math.min((A.resize.x||0)/m,1),M=Math.min((A.resize.y||0)/u,1),C=Math.min(w,M);h=~~(m*C),p=~~(u*C);break}}(h!==a.width||p!==a.height)&&(console.log(`resize ${h} ${p} ${a.width} ${a.height}`),a.width=h,a.height=p),a.style.width=`${n.view*a.width/16}rem`,A.process.device===U.GL&&A.liveRender?o():t({type:x.Status,payload:R(b({},n.status),{renderStatus:V.Ready,renderWidth:a.width,renderHeight:a.height})})}},[n.options,n.renderTarget]);const o=()=>{const A=e==null?void 0:e.querySelector("canvas"),a=n.options.process.process;if(!A||!a)return;const m=Date.now();t({type:x.Status,payload:R(b({},n.status),{renderStatus:V.Rendering})}),a.run(A,n.options).then(()=>{const u=Date.now()-m;t({type:x.Status,payload:R(b({},n.status),{renderStatus:V.Done,lastRenderTime:u,renderWidth:A.width,renderHeight:A.height})})})},l=()=>{n.view>1&&t({type:x.View,payload:n.view>4?n.view/2:n.view-1})},r=()=>{n.view<16&&t({type:x.View,payload:n.view<4?n.view+1:n.view*2})},s=A=>{const a=A;!(a.buttons&1)||e==null||e.scrollBy(-a.movementX,-a.movementY)};return E("div",{className:"dlab-root",children:[E("div",{className:"dlab-content bevel content",children:[E("div",{className:"dlab-control-bar bevel",children:[i("div",{className:"dlab-control dlab-control-save",children:i("button",{className:"bevel light hover icon-button",onClick:()=>{const A=e==null?void 0:e.querySelector("canvas");if(!A)return;const a=A.toDataURL("image/png").replace("image/png","image/octet-stream"),m=document.createElement("a");m.setAttribute("download","result.png"),m.setAttribute("href",a),m.click()},children:i("img",{src:nn,alt:"Save"})})}),E("div",{className:"dlab-control dlab-control-view",children:[i("span",{children:"Zoom"}),E("div",{className:"bevel content",children:[i("button",{className:"bevel",onClick:l,disabled:n.view<=1,children:"-"}),i("input",{type:"text",readOnly:!0,value:`${n.view*100}%`}),i("button",{className:"bevel",onClick:r,disabled:n.view>=16,children:"+"})]})]}),i("hr",{className:"divider bevel vertical"}),E("div",{className:"dlab-control dlab-control-render",children:[i("input",{type:"checkbox",id:"dlab-live-render",name:"dlab-live-render",checked:n.options.liveRender,disabled:n.options.process.device===U.CPU,onChange:A=>t({type:x.Live,payload:A.nativeEvent.target.checked})}),i("label",{htmlFor:"dlab-live-render",children:"Live Render"}),i("button",{className:"bevel",onClick:o,disabled:!n.options.image.element||n.status.renderStatus===V.Rendering,children:"Render"})]})]}),i("div",{className:"dlab-image-area",ref:A=>e=A,onMouseMove:A=>s(A.nativeEvent),children:n.options.image.element?n.renderTarget:i("span",{children:"[No image loaded]"})}),E("div",{className:"dlab-tool-pane",children:[i(k,{title:"Source Image",children:i(Je,{options:n.options.image,onChange:A=>t({type:x.Image,payload:A})})}),i(k,{title:"Resize",children:i(He,{options:n.options.resize,onChange:A=>t({type:x.Resize,payload:A})})}),i(k,{title:"Color Palette",children:i(Ct,{options:n.options.palette,onChange:A=>t({type:x.Palette,payload:A})})}),i(k,{title:"Process",children:i(en,{options:n.options.process,onChange:A=>t({type:x.Process,payload:A})})})]})]}),E("div",{className:"dlab-status-bar",children:[E("div",{className:"dlab-status bevel inset light",children:[n.status.renderStatus,n.status.renderStatus===V.Done&&` (${n.status.lastRenderTime}ms)`]}),i("div",{className:"dlab-status bevel inset light",children:n.status.renderWidth?`${n.status.renderWidth}x${n.status.renderHeight}`:""})]})]})}const on={title:"DitherLab",minWidth:960,minHeight:720,iconUrl:q,children:i(an,{})};var Se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAWlBMVEUAAACGhoYEBAQAAID/+/DAwMD//wDn59bMADP/zADq6ur////MAAClACH/AABmmWYAgAAAgIAAAP8A/wAA//8AmcwAmQCysrL/AP+ZZpmAgACAAACAAICZmQA2GEugAAAAAXRSTlMAQObYZgAAAAFiS0dECx/XxMAAAAAHdElNRQfiBBAHOBbUxf5ZAAABgUlEQVRIx7WVi3KDIBBFo8Cy+IgmTVptkv//zQILYoIIaadn0FkNZwC5Qw6Hd6ny1M8Cy1IocFFTKxWEqKmVCrWnVEiuQUTAy/OrIKUE0DeJaO4SlHwiEhrOOWDrQcWfiAVpXqM2zKVvvEiwhunf8UKB92hp80JDP2Cv6fK5qkDpJXPssBdVj+zIgJmW3JMKgCst4CKoWFjnalmDnVJBroJg6PK5Wj5rr9fBELO5IqHt0HxYIcy1hxfA7q/JVYdyByvofQBFq9B1q+eWRPoRXN7caGoYXYeThqrz+cxWgg+HrT8gCJcTc8LlGgtuhGHYEq5BaHx/7IwwjuPnGGZEAu13YgSzQe4FdePLy21hh18KzUrQtY29e15KV22OYBNAz6H8osoJC4VTChQJ9QpazzRNs+vwraHqeMRb6gSZYL57AR5egLQwz0F4eAH7pHA3hBmRcDOkRlhFI5QhGpuH2t5X2jw23xJy0YimtBkNEaLx1yllENk/yPggW1MXcPh3fgBrZiSYigysdQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0wNC0xNlQwNzo1NjoyMi0wNDowMHPebskAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMDQtMTZUMDc6NTY6MjItMDQ6MDACg9Z1AAAAAElFTkSuQmCC",rn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAYFBMVEUAAADMzGb///+ZmWb//4D/zDNmZmbMM8wzMzOAAICysrKAgIAzM5n/zGbMmTOWlpZ3d3fAwMBmzACGhoYAgADMMzNmAADMmZmZZmaAAAAAAID/ZmaZMzNfX1+ZAADj4+ODtItOAAAAAXRSTlMAQObYZgAAAAFiS0dEAmYLfGQAAAAHdElNRQfiBhoANRcGXhUDAAAB2klEQVRIx62VC3eCIBiGC5R9hptRaq3W+v//ct8FFBC7nLO3czbD99kjiG6zKWfL2bycreLo1/sVpzYv9z8wRMAr/Rr/foNA8xjY2RACiGhYYaOkQOtTywSahn9BOycHPr/aru32HvCpiXAdfUoAjjsCDocEOHb0aR9c0iEjipfkfBDA/qGfCfBn1oF+ArR2VV1DGdhJ6JL63veVMiyhEwtA9o+KV8kDSOCJx8AwDPjTGeOeAkxgfxiT2/EfwOl8/g7EKH1c/Ms6cB2GnzEoRt/3RAk4XekybvFCXeL+AqC+VyijBLlcpF8CWBAUygSE6/RtAUg/KAipfaSeAzKDWcGIJHxPARb8xopFEkAEx2uiyKLtQsDAmkIbWAiOal2h7+AgFyi1qtB3C2oiJoFaU+h7Bbg7IResKbBvIyASlBXYr8DOQCQoKLSmvmJAJiGC65RUod0O95MSQBR+F8WZFfgaAD4A2HvgVABmxQxYOoAgGOOwwr/WNE5XXuPWGQZEgGs0RQZu8i8hBsQQ+tnG+hllq2l82vipAJAbEQSLrT7e+Nho7QFredIFQVDIGD5BWgBZVplm2s8HmZhunEw0BfJBIuK99DxEvAUQ8R7AhHJvAEjAW31aX+r/AfezPDUVx2F1AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTA2LTI2VDAwOjUzOjIzLTA0OjAwad31FAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0wNi0yNlQwMDo1MzoyMy0wNDowMBiATagAAAAASUVORK5CYII=";const sn=[{id:"theme",display:"System Theme",iconUrl:rn,template:Oe},{id:"dlab",display:"DitherLab",iconUrl:Se,template:on}];function ln(e){return i("div",{className:"launch-root bevel content",children:sn.map((n,t)=>E("div",{className:"launch-item",onDoubleClick:()=>e.onLaunch(n.template),children:[i("img",{src:n.iconUrl||Se,alt:n.id,className:"launch-icon"}),i("div",{className:"launch-label",children:n.display})]},t))})}const cn=e=>({title:"Program Manager",minWidth:480,minHeight:320,iconUrl:q,children:i(ln,{onLaunch:e.onLaunch})});var B=(e=>(e[e.Restored=0]="Restored",e[e.Maximized=1]="Maximized",e))(B||{}),D=(e=>(e[e.N=1]="N",e[e.E=2]="E",e[e.S=4]="S",e[e.W=8]="W",e[e.NE=3]="NE",e[e.SE=6]="SE",e[e.SW=12]="SW",e[e.NW=9]="NW",e))(D||{}),An="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAYAAACALL/6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAHaGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4NmU4YTE1Mi02N2FlLTkyNDktYTU3Mi1iZjk2OTY3M2I3YTAiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDozZGQ2ZDUzNy04MmI2LTFlNDUtOTUzMS1mNjUyZGNmNDgxN2YiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDc4ZjAwNTctNjliOS03NTQ0LTlmZTgtMWQ2MmFmNzFmMTczIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjAtMDEtMjNUMTg6NTA6MzktMDM6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTAyLTE2VDIwOjI2OjE3LTAzOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTAyLTE2VDIwOjI2OjE3LTAzOjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Zjk1NzQxYmItMmNlOS0xYTQ1LWJmNjAtY2NkOGFhYWMyYzc1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjg2ZThhMTUyLTY3YWUtOTI0OS1hNTcyLWJmOTY5NjczYjdhMCIvPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpkYmQ3MWE1YS05ZDJlLWU1NDMtODY1ZC00MTMxZTQ4NWYyOTUiIHN0RXZ0OndoZW49IjIwMjAtMDItMTZUMjA6MjY6MTctMDM6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MDc4ZjAwNTctNjliOS03NTQ0LTlmZTgtMWQ2MmFmNzFmMTczIiBzdEV2dDp3aGVuPSIyMDIwLTAyLTE2VDIwOjI2OjE3LTAzOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDxyZGY6QmFnPiA8cmRmOmxpPnhtcC5kaWQ6RkVGM0NCMzUzRTE0MTFFQTkzNjBCQTIzMTFCMDU4MkY8L3JkZjpsaT4gPC9yZGY6QmFnPiA8L3Bob3Rvc2hvcDpEb2N1bWVudEFuY2VzdG9ycz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5ChT8fAAAAZElEQVQYlZWQwQ6AMAxC6eJ/E768XiapqAd32UJ5Kay6G3/OcT0kXWSRROokCwDWgGvfLSnNANAJJDTNnhnIwdQkWassPbrYMzutNzPJudGdbkBm3jHc6SuSvzZiWT9ikMaHfgKtlTaQpMV5nwAAAABJRU5ErkJggg==",mn="data:image/png;base64,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UmVhZHlxyWU8AAADdmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjg2ZThhMTUyLTY3YWUtOTI0OS1hNTcyLWJmOTY5NjczYjdhMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxRDA4MzExQjRGMzExMUVBQUY2RENBNDQ4NDJFNDc3RCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxRDA4MzExQTRGMzExMUVBQUY2RENBNDQ4NDJFNDc3RCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0ZGFjMGIxMC04MzFlLThjNDAtOTYxMy1iY2FiY2NjZjNjM2IiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6ODZlOGExNTItNjdhZS05MjQ5LWE1NzItYmY5Njk2NzNiN2EwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+UJGQOgAAALNJREFUeNqMUQkOgjAQnG0rVp9k4hExMT4aEI8ncZVjLQGRy+ikzXY203RmS8yMGrfQg0CO7eHSNEawOqqr+DSoT79CdSeSdjU0uD6ogsRSLZBmMU7ujvtPobXFc9vz762s0f30UFXlgNM7NBFx6D9JOQtESQQWjLN75HFo1b8thYExCdYrbatppxdQXmadZmBJ2KjEBbI0hta66QkBJWlmShabvTv5A5MVcLScZvgXLwEGAC40VyoZQ2c/AAAAAElFTkSuQmCC";function dn(e){const[n,t]=S.exports.useState({x:e.left||0,y:e.top||0}),[o,l]=S.exports.useState({w:Math.max(e.width||0,e.minWidth),h:Math.max(e.height||0,e.minHeight)}),[r,s]=S.exports.useState(B.Restored);S.exports.useEffect(()=>w(!0),[]);let d=null;const A=(()=>{switch(r){case B.Restored:return{width:e.autoSize?"auto":o.w,height:e.autoSize?"auto":o.h,left:n.x,top:n.y};case B.Maximized:return{width:"100%",height:"100%",left:0,top:0}}})(),a=g=>{if(g.button!==0)return;const c=I=>{if(!d)return;const N=d.getBoundingClientRect();d.style.left=`${N.left+I.movementX}px`,d.style.top=`${N.top+I.movementY}px`},T=I=>{if(I.button===0){if(d&&d.parentElement){const N=d.getBoundingClientRect(),f=d.parentElement.getBoundingClientRect();t({x:N.left-f.left,y:N.top-f.top})}window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",T)}};window.addEventListener("mousemove",c),window.addEventListener("mouseup",T)},m=(g,c)=>{if(g.button!==0)return;const T=N=>{if(!d)return;const f=d.getBoundingClientRect(),F=(e.maxHeight||Number.MAX_VALUE)-f.height,G=f.height-e.minHeight,se=(e.maxWidth||Number.MAX_VALUE)-f.width,le=f.width-e.minWidth;if(c&D.N){const Z=N.movementY<0?Math.max(N.movementY,-F):Math.min(N.movementY,G);d.style.top=`${f.top+Z}px`,d.style.height=`${f.height-Z}px`}else if(c&D.S){const Z=N.movementY>0?Math.min(N.movementY,F):Math.max(N.movementY,-G);d.style.height=`${f.height+Z}px`}if(c&D.W){const Z=N.movementX<0?Math.max(N.movementX,-se):Math.min(N.movementX,le);d.style.left=`${f.left+Z}px`,d.style.width=`${f.width-Z}px`}else if(c&D.E){const Z=N.movementX>0?Math.min(N.movementX,se):Math.max(N.movementX,-le);d.style.width=`${f.width+Z}px`}},I=N=>{if(N.button===0){if(d&&d.parentElement){const f=d.getBoundingClientRect(),z=d.parentElement.getBoundingClientRect();t({x:f.left-z.left,y:f.top-z.top}),l({w:f.width,h:f.height})}window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",I)}};window.addEventListener("mousemove",T),window.addEventListener("mouseup",I)},u=(g,c)=>{if(g.button!==0)return;const T=N=>{c(N),I()},I=()=>{window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",I)};window.addEventListener("mousemove",T),window.addEventListener("mouseup",I)},h=()=>{e.maximizable!==!1&&(r===B.Maximized?s(B.Restored):s(B.Maximized))},p=()=>{e.onClose&&e.onClose(e.id)},w=(g=!1)=>{if(!d)return;const c=parseInt(d.style.zIndex||"0"),T=document.querySelectorAll(".win-frame"),I=[];for(let f=0;f<T.length;f++)T.item(f).id!==d.id&&I.push(T.item(f));g||I.forEach(f=>{const z=parseInt(f.style.zIndex||"0");z>c&&(f.style.zIndex=(z-1).toString())});const N=I.map(f=>parseInt(f.style.zIndex||"0")).reduce((f,z)=>Math.max(f,z),0);d.style.zIndex=(N+1).toString()},M=!e.autoSize&&e.resizeable!==!1,C=[i("div",{className:"win-resize-handle-nw",onMouseDown:g=>u(g.nativeEvent,c=>m(c,D.NW))},"nw"),i("div",{className:"win-resize-handle-n",onMouseDown:g=>u(g.nativeEvent,c=>m(c,D.N))},"n"),i("div",{className:"win-resize-handle-ne",onMouseDown:g=>u(g.nativeEvent,c=>m(c,D.NE))},"ne"),i("div",{className:"win-resize-handle-w",onMouseDown:g=>u(g.nativeEvent,c=>m(c,D.W))},"w"),i("div",{className:"win-resize-handle-e",onMouseDown:g=>u(g.nativeEvent,c=>m(c,D.E))},"e"),i("div",{className:"win-resize-handle-sw",onMouseDown:g=>u(g.nativeEvent,c=>m(c,D.SW))},"sw"),i("div",{className:"win-resize-handle-s",onMouseDown:g=>u(g.nativeEvent,c=>m(c,D.S))},"s"),i("div",{className:"win-resize-handle-se",onMouseDown:g=>u(g.nativeEvent,c=>m(c,D.SE))},"se")];return console.log(`render window ${e.id} @ ${n.x}, ${n.y} [${o.w}x${o.h}] State: ${r}`),E("div",{className:"win-frame bevel",id:`win_${e.id}`,style:A,ref:g=>d=g,onMouseDown:()=>w(),children:[E("div",{className:"win-main",children:[E("div",{className:"win-titlebar",onMouseDown:r===B.Restored?g=>u(g.nativeEvent,c=>a(c)):void 0,onDoubleClick:h,children:[i("img",{className:"win-titlebar-icon",src:e.iconUrl||q,alt:"icon"}),i("div",{className:"win-titlebar-spacer"}),i("div",{className:"win-title",children:e.title}),i("div",{className:"win-titlebar-spacer"}),E("div",{className:"win-titlebar-button-group",children:[e.maximizable!==!1&&i("button",{className:"win-titlebar-button icon-button bevel",onClick:h,children:i("img",{src:r===B.Maximized?mn:be,alt:"max"})}),i("button",{className:"win-titlebar-button icon-button bevel",onClick:p,disabled:e.closeable===!1,children:i("img",{src:e.closeable?An:fe,alt:"x"})})]})]}),i("div",{className:"win-content",children:e.children})]}),M&&r===B.Restored&&C]})}let j={x:100,y:100};function un(){const[e,n]=S.exports.useState(0),[t,o]=S.exports.useState([]),[l,r]=S.exports.useState();S.exports.useEffect(()=>{l&&(s(l),r(void 0))},[l]);const s=a=>{const m=R(b({id:e},a),{top:a.top||j.y,left:a.left||j.x});o(t.concat(m)),n(e+1),j={x:100+(j.x-50)%500,y:100+(j.y-50)%300}},d=a=>{o(t.filter(m=>m.id!==a))},A=a=>{r(a)};return E("div",{className:"desktop",children:[i("button",{className:"bevel",onClick:()=>s(cn({onLaunch:A})),children:"Program Manager"}),t.map(a=>i(dn,R(b({},a),{onClose:d,children:a.children}),a.id))]})}function hn(){return i("div",{className:"app",children:i(un,{})})}const De=()=>{const e=window.devicePixelRatio,n=Math.round(e)/e;document.documentElement.style.fontSize=`${16*n}px`};window.onresize=De;De();const ve=localStorage.getItem("__theme");ve&&(document.documentElement.className=ve);Ye.render(i(we.StrictMode,{children:i(hn,{})}),document.getElementById("root"));
